import psycopg2

class postgreSQL:
    def __init__(self, database, user, password, host, port):
        self.connection = psycopg2.connect(
        database=database, 
        user=user, 
        password=password, 
        host=host,   
        port=port
        )
        self.cursor = self.connection.cursor()
    def devTestAddUserInBD(self, userId, chatId, firstName, username, pidorCount, date):
        with self.connection:
            return self.cursor.execute(
                f"INSERT INTO users (userid,chatid,first_name,username,pidorCount,date) VALUES ({userId}, {chatId}, '{firstName}', '{username}', {pidorCount}, {date})"
            )
    
    def createTableUsers(self):
        with self.connection:
            self.cursor.execute('''CREATE TABLE IF NOT EXISTS users (
            id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
            userid BIGINT NOT NULL,
            chatid BIGINT NOT NULL,
            first_name character(256),
            username character(256),
            pidorCount BIGINT,
            date BIGINT
            );''')

    def close(self):
        self.connection.close()